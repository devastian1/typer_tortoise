<% if admin_user? %><%= render 'nav' %><% end %>

<h1>Snippet Index</h1>

<div class="filter-dropdown">
  <div class="row">
    <div class="col-md-3">
      Filtering:
      <%= select_tag "category_id",
          "<option value=''>No Filtering</option>".html_safe + options_from_collection_for_select(@categories, :id, :name, params[:category_id]),
          id: 'category_filter', class: 'form-control' %>
    </div>
  </div>
</div>

<%= paginate @snippets %>

<div class="row">
  <div class="col-md-12">
    <table class="table table-bordered table-striped snippets-table">
      <tr>
        <th class="row-category">Category</th>
        <th class="row-text">Text</th>
        <th class="row-characters">Characters</th>
        <th class="row-actions" colspan="<%= admin_user? ? 4 : 2 %>"></th>
      </tr>

      <% @snippets.each do |snippet| %>
        <tr>
          <td><strong><%= snippet.category.name %></strong></td>
          <td style="white-space: pre;"><%= snippet.full_text %></td>
          <td><%= snippet.full_text.length %></td>
          <td><%= link_to 'Show', snippet %></td>
          <td><%= link_to 'Play', play_snippet_path(snippet) %></td>
          <% if admin_user? %>
            <td><%= link_to 'Edit', edit_snippet_path(snippet) %></td>
            <td><%= link_to 'Destroy', snippet, data: { confirm: 'Are you sure?' }, method: :delete %></td>
          <% end %>
        </tr>
      <% end %>
    </table>
  </div>
</div>
